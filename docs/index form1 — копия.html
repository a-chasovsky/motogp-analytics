<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HPP</title>
    <link rel="shortcut icon" type="image/x-icon" href="favicon.png">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6">
        </script>
    <script id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
        </script>
</head>
<style>
    /* html {
        scroll-behavior: smooth;
    } */
    body {
        background-color: #FFFFFF
    }
    .main-container {
        width: 810px;
        border-right: 1px solid #CFD7DE;
        border-left: none;
        padding: 0 30px 0 0;
    }
    .sub-container {
        width: 750px;
        border-right: none;
        border-left: 1px solid #CFD7DE;
        margin-left: 22.5%;
        padding: 0 0 0 30px;
    }
    #toc_container {
        background: #FFFDFF;
        width: 720px;
        border: 1px solid #CFD7DE;
        display: table;
        font-size: 95%;
        margin-bottom: 1em;
        padding: 5px 20px 20px 20px;
        margin-top: 0px;
        border-radius: 5px; 
    }
    h1 { 
        font-family: system-ui;
        color: #303030;
        font-size: 1.5em;
        font-weight: 600;
        text-align: left;
        line-height: 1.25;
    }
    h2 {
        font-family: system-ui;
        color: #252525;
        font-size: 1.3em;
        font-weight: 600;
        text-align: left;
        line-height: 1.5em;
    }
    h3 {
        font-family: system-ui;
        color: #252525;
        font-size: 1.15em;
        font-weight: 600;
        text-align: left;
        line-height: 1.25em;
    }
    h4 {
        font-family: system-ui;
        color: #252525;
        font-size: 1em;
        font-weight: 600;
        text-align: left;
        line-height: 1.25;
        margin-bottom: 0px;
    }
    h5 {
        font-family: system-ui;
        font-style: italic;
        color: #252525;
        font-size:0.85em;
        font-weight: 400;
        text-align: left;
        line-height: 1.25em;
        margin-top: -5px;
        margin-bottom: 0px;
    }
    p {
        font-family: system-ui;
        font-size: 1em;
        color: #151515;
        line-height: 1.5;
        margin: 12.5px 0 0 0;
        text-align: justify
    }
    img-center {
        display: flex;
        justify-content: center;
        padding-right: 0px;
        padding-left: 0px
    }
    img-margin {
        margin-left: 30px;
    }
    .toc_title {
        font-weight: 600;
        text-align: left;
        font-family: system-ui;
        color: #252525;
        padding: 10px 0 10px 0;
    }
    text-number-toc {
        font-family: system-ui;
        font-weight:600;
        color: #333333;
        font-size: 0.85em;
        text-align: justify;
        line-height: 1.5;
    }   
    a {
        scroll-margin-top: 15px;
    }
    a:link {
        font-family: system-ui;
        text-decoration: none;
        color: #164B84;
    }
    a:visited {
        font-family: system-ui;
        color: #164B84;
    }
    a:hover {
        font-family: system-ui;
        color: #2373C7;
        text-decoration: none;
    }
    a:active {
        font-family: system-ui;
        color: #2D8CF1;
    }
    sb {
        font-weight: 600;
        font-color: red;
    }
    line-height-1-75 {
        line-height: 1.75em;
    }
    space {
        display: block;
        margin-top: 12.5px;
        content: ' '
    }
    space20 {
        display: block;
        margin-top: 20px;
        content: ' '
    }
    space25 {
        display: block;
        margin-top: 25px;
        content: ' '
    }
    ul {
        list-style-type: disc;
        line-height: 1.5;
        margin-top: 5px;
        color: #151515;
    }
    li {
        font-family: system-ui;
        line-height: 1.75em;
        text-align: justify
    }
    #toTocBtn {
      display: none;
      position: fixed;
      margin-left: 880px;
      bottom: 35px;
      z-index: 99;
      border: none; 
      outline: none; 
      background-color: #F1F1F1;
      color: #1B60AA; 
      cursor: pointer; 
      padding: 15px; 
      border-radius: 5px;
      font-size: 14px;
    }
    #toTocBtn:hover {
      background-color: #E1E1E1;
      border: none; 
      color: #1B60AA;
    }
    .sub-container span a:link {
        font-family: system-ui;
        color: #164B84;
        font-size: 0.85em;
        margin-left: 2.5px;
        text-decoration: none;
    }
    .sub-container span a:visited {
        font-family: system-ui;
        color: #164B84;
        font-size: 0.85em;
        margin-left: 2.5px;
        text-decoration: none;
    }
    .sub-container span a:hover {
        font-family: system-ui;
        color: #2373C7;
        font-size: 0.85em;
        margin-left: 2.5px;
        text-decoration: none;
    }
    .sub-container span a:active {
        font-family: system-ui;
        color: #2D8CF1;
        font-size: 0.85em;
        margin-left: 2.5px;
        text-decoration: none;
    }
    span.emoji {
        font-size: 20px;
    }
    pageend {
        display: block;
        margin-top: 75px;
        content: ' '
    }
    .change-size {
        transform: scale(1.5);
        border: 1px solid #CCCCCC;
        border-radius: 3px;
    }
</style>
<body>
<div class='sub-container' style='border-left:none'>
    <img src='img/header.png'
        style='width:760px'>
    <h1>
        Сочетание регрессионного анализа и машинного обучения для повышения точности и интерпретируемости модели
        </h1>
    <h5>
        Регрессионный анализ, машинное обучение, описательная аналитика, предиктивная аналитика
        </h5>
    <span style='padding-left:17px;margin-top:15px;margin-bottom:15px;display:inline-block;scroll-margin-top:15px;' id='links'>
        <a href='https://github.com/a-chasovsky/kgl_house_prices' target='_blank'>
            <span class='emoji' style='vertical-align: -0.1em;'>
                &#127969;
                </span>
            <span style='margin-left:2px;'>
                Ссылка на репозиторий
                </span>
            </a>
            &emsp;
        </span>
    <span style='margin-top:15px;margin-bottom:15px;display:inline-block;scroll-margin-top:15px;'>
        <a href='https://github.com/a-chasovsky' target='_blank'>
            <span>
                <img src='img/github-logo.png' style='width:20px;vertical-align:top'>
                </span>
            <span style='margin-left:4px;'>
                Профиль Github 
                </span>
            </a>
        </span>
    </div>
<div class='sub-container'>
    <div id="toc_container">
            <div class='toc_title'>
                Содержание <a class='anchor' id="#toc"></a>
                </div>
             <line-height-1-75>
                <text-number-toc>1.</text-number-toc> <a href="#review">Обзор и краткие результаты</a><br>
                <div class='toc_title' style='font-size:0.9em;line-height:1;margin:0 0 0 15px;'>
                    <i>Секция 1. Исследование и подготовка данных</i>
                    </div>
                <text-number-toc>2.</text-number-toc> <a href="#dataset_description">Описание датасета</a><br>
                <text-number-toc>3.</text-number-toc> <a href="#missed_values">Заполнение отсутствующих значений</a><br>
                <text-number-toc>4.</text-number-toc> <a href="#model_base">ML-модель №1 (базовая)</a><br>
                <text-number-toc>5.</text-number-toc> <a href="#eda">Исследование данных</a><br>
                <text-number-toc>6.</text-number-toc> <a href="#clear">Очистка и проверка на несоответствие</a><br>
                <text-number-toc>7.</text-number-toc> <a href="#model_inter1">ML-модель №2 (после очистки данных)</a><br>
                <text-number-toc>8.</text-number-toc> <a href="#feature_engineering">Создание дополнительных предикторов (feature engineering)</a><br>
                <text-number-toc>9.</text-number-toc> <a href="#preprocessing">Предварительная подготовка данных</a><br>
                <text-number-toc>10.</text-number-toc> <a href="#model_inter2">ML-модель №3 (после создания новых признаков)</a><br>
                <div class='toc_title' style='font-size:0.9em;line-height:1;margin:0 0 0 20px;'>
                    <i>Секция 2. Регрессионный анализ</i>
                    </div>
                <text-number-toc>11.</text-number-toc> <a href="#elastic_net">Эластичная сеть</a><br>
                <text-number-toc>12.</text-number-toc> <a href="#linear_regression">Линейная регрессия</a><br>
                <text-number-toc>13.</text-number-toc> <a href="#simulations">Результаты линейных моделей на сэмплированных данных</a><br>
                <div class='toc_title' style='font-size:0.9em;line-height:1;margin:0 0 0 21px;'>
                    <i>Секция 3. Машинное обучение</i>
                    </div>
                <text-number-toc>14.</text-number-toc> <a href="#ml_algorithms">Выбор ML-модели для прогнозирования остатков линейной регрессии</a><br>
                &emsp;<text-number-toc>14.1</text-number-toc> <a href="#ml_simple">Опорные вектора, бустинги, бэггинг, случайный лес, K-ближайших соседей</a><br>
                &emsp;<text-number-toc>14.2.</text-number-toc> <a href="#vote_stack">Добавление оценщиков верхнего уровня - Voting и Stacking</a><br>
                &emsp;<text-number-toc>14.3.</text-number-toc> <a href="#residuals_final">Сравнение всех моделeй и выбор финального оценщика остатков регрессии</a><br>
                &emsp;<text-number-toc>14.4.</text-number-toc> <a href="#hpp">Объединение линейной регрессии и ML-алгоритма в итоговый оценщик HPP</a><br>
                <text-number-toc>15.</text-number-toc> <a href="#ml_models">Оценка независимых ML-моделей</a><br>
                <div class='toc_title' style='font-size:0.9em;line-height:1;margin:0 0 0 22px;'>
                    <i>Секция 4. Подведение итогов</i>
                    </div>
                <text-number-toc>16.</text-number-toc> <a href="#comparison">Сравнение всех моделей</a><br>
                <text-number-toc>17.</text-number-toc> <a href="#actual_predicted_prices">Актуальные и спрогнозированные цены</a><br>
                <text-number-toc>18.</text-number-toc> <a href="#residuals_hpp">Анализ остатков HPP</a><br>
                <text-number-toc>19.</text-number-toc> <a href="#further">Дальнейшие шаги</a><br>
                </line-height-1-75>
            </div>
    <h2>
        <a
            class='anchor'
            id='review'>
            </a>
        1. Обзор и краткие результаты
        </h2>
    <h3>
        Цель
        </h3>
    <div class='main-container'>
        <button onclick="scrollToID('links')" id="toTocBtn">
            К содержанию
            </button>
        <p>
            Современные алгоритмы машинного обучения обычно превосходят классические линейные модели в точности прогнозов, но при этом сложны в интерпретации. Некоторые алгоритмы имеют встроенный функционал приоритизации предикторов, но этого недостаточно для оценки взаимосвязей в данных.<br>
            <space></space>
            Целью данного проекта является создание простой в интерпретации модели <sb>HousePricePredictor</sb>, которая по точности прогнозов не уступает лучшим алгоритмами машинного обучения. Модель состоит из двух уровней: на первом уровне линейная регрессия формирует первичные прогнозы и коэффициенты для интерпретации; второй уровень - это алгоритм машинного обучения, который прогнозирует величину остатков (ошибок) регрессии и корректирует результаты. Эта схема во многом напоминает первую итерацию бустинга, в котором каждая последующая итерация минимизирует ошибку предыдущей.
            </p>
        <h3>
            Этапы
            </h3>
        <h4>
            <i>Секция 1: Исследование и подготовка данных</i>
            </h4>
        <p>
            На первом этапе проводится первичный анализ данных, визуализация, а также необходимые преобразования. Среди прочего заполняются пропущенные значения, выявляются и исправляются противоречия в данных, определяются наиболее значимые и создаются дополнительные предикторы, данные кодируются и стандартизируются. По итогам каждого этапа преобразований обучается промежуточная ML-модель LightGBM. 
            <space></space>
            <i>Результаты:</i>
            </p>
        <ul>
            <li>очищенный и преобразованный датасет;</li>
            <li>датасеты для пайплайнов секции машинного обучения;</li>
            <li>три промежуточные ML-модели.</li>
        </ul>
        <h4>
            <i>Секция 2: Регрессионный анализ</i>
            </h4>
        <p>
            В этом разделе рассматриваются две регрессионные модели: эластичная сеть и линейная регрессия (без регуляризации). 
Для эластичной сети подбирается оптимальное значение гиперпараметра \( \alpha \) и строится график зависимости RMSE от числа используемых предикторов. Десять наиболее релевантных предикторов используются для построения линейной регрессии. После диагностики регрессии, она сравнивается с эластичной сетью с применением ресэмплинга.
            <space></space>
            В дальнейшем результаты эластичной сети используются как бенчмарк эффективности линейных регрессионных моделей, а линейная регрессия станет первым уровнем итогового оценщика HPP. 
        <space></space>
        <i>Результаты:</i>
            </p>
        <ul>
            <li>линейная модель для первого уровня итогового оценщика HPP</li>
            <li>эластичная сеть для сравнения с другими моделями.</li>
        </ul>
        <h4>
            <i>Секция 3: Машинное обучение</i>
            </h4>
        <p>
            Секция машинного обучения состоит из двух частей.
            <space></space>
            В первой части осуществляется выбор алгоритма, который будет прогнозировать <sb>остатки</sb> (ошибки) линейной регрессии. Здесь оцениваются разные типы ML-алгоритмов: метод ближайших соседей, бэггинг, случайный лес, бустинг, стэкинг. Самый эффективный алгоритм будет использоваться на втором уровне итогового оценщика HPP. Его прогнозы используются для коррекции прогнозов регрессии, что теоретически должно привести к увеличению точности предсказания цены. Для выбора лучшего алгоритма используется 20-фолдовая перекрестная проверка.
            <space></space>
            Во второй части секции по аналогичной схеме с 20-фолдовой кросс-валидацией определяется лучшая модель машинного обучения, прогнозирующая <sb>цену</sb> дома. Эта модель - очередной бенчмарк эффективности (в дополнение к моделям из предыдущих секций) для итогового оценщика HPP.
            <space></space>
            <i>Результаты:</i>
            </p>
        <ul>
            <li>ML-модель для прогноза остатков регрессии;</li>
            <li>ML-модель для прогноза цены дома.</li>
            </ul>
        <h4>
            <i>Секция 4: Подведение итогов</i>
            </h4>
        <p>
            На заключительном этапе проводится сравнение имеющихся моделей, делается заключение об эффективности оценщика HPP, исследуются остатки его прогнозов, предлагаются шаги для дальнейшего исследования данных и развития структуры HPP.
        <space></space>
        <i>Результаты:</i>
            </p>
        <ul>
            <li>оценка HPP;</li>
            <li>рекомендации по дальнейшим шагам.</li>
        </ul>
        <h3>
            Результаты
            </h3>
        <h4>
            <i>Предсказательная эффективность HousePricePredictor (HPP)</i>
            </h4>
        <p>
            График демонстрирует эффективность прогнозирования семи моделей, построенных на разных стадиях проекта.
            </p>
            <ul>
                <li>Base - базовая модель LightGBM после удаления пропусков;</li>
                <li>Base (Clean) - промежуточная модель LightGBM после очистки данных;</li>
                <li>Base (FE) - промежуточная модель LightGBM после генерации новых признаков;</li>
                <li>Elastic Net - лучшая регрессионная модель (эластичная сеть);</li>
                <li>SVM - лучшая линейная ML-модель;</li>
                <li>Stacking - лучшая ML-модель;</li>
                <li>HousePricePredictor(HPP) - модель, полученная в результате комбинации линейной регрессии и стэкинга.</li>
            </ul>
            <img 
                src='img/Section8-Final-predictions/final_plot.png'
                style="display:block;background-color:#FFFFFF;"
                onclick='clickSize(this)'>
            <space></space>
        <p>
            В ходе проекта удалось снизить ошибку RMSE c 0.1216 у базовой модели до 0.0969 итогового оценщика HousePricePredictor. На этапе преобразования наибольший вклад внесла очистка данных, а несколько дополнительно сгенерированных предикторов полезны как для линейной регрессии, так и для более сложных алгоритмов машинного обучения (см. <i>'8. Создание дополнительных предикторов'</i>, <i>'12. Линейная регрессия'</i>, <i>'15. Оценка независимых ML-моделей'</i>).
            <space></space>
            Результат итогового оценщика HPP превысил ожидания - это единственная модель, у которой ошибка на тестовых данных не превышает 0.1. Доверительные и предиктивные интервалы для всех моделей примерно одинаковы.
            <space></space>
            Три лучшие модели демонстрируют неплохую дисперсию - их результаты на кросс-валидации достаточно кучны, за исключением нескольких выбросов (см. нижний график). Для HPP это пять элементов с заметно более высоким значением ошибки.
            </p>
        <h4>
            <i>Интерпретациия модели</i>
            </h4>
        <p>
            Ядром HousePricePredictor является классическая линейная регрессия. Коэффициенты и доверительные интервалы представлены в таблице ниже.
            <space20></space20>
            <img-margin>
                <img 
                    src='img/Section4-Linear-models-research/coefficients_table.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-margin>
            <space></space>
            Предикторы с наибольшими коэффициентами - <sb>lg_flrsfmean</sb> (дополнительно сгенерированный предиктор - средневзвешенная площадь первого и второго этажей, см. <i>'8.1. Предикторы, характеризующие площадь'</i>), <sb>overallqual</sb> (качество строительных и отделочных материалов) и <sb>houseage</sb> (возраст дома). 
            <space></space>
            Оценка вклада каждого из этих параметров (при прочих равных):
            </p>
            <ul>
                <li>С увеличением средневзвешенной площади этажей на 1% цена увеличивается на 0.144%;</li>
                <li>С увеличением качества материалов на 1 пункт цена увеличивается на 8.8%;</li>
                <li>С увеличением возраста дома на 1 год цена уменьшается на 8.5%</li>
            </ul>
        <p>
            Интерпретацию остальных коэффициентов см. в разделе <i>'12. Линейная регрессия'.</i>
            </p>
        <h4>
            <i>Визуализация актуальных и предсказанных HousePricePredictor цен</i>
            </h4>
            <space></space>
            <img-center>
                <img
                    src='img/Section8-Final-predictions/predicted_actual_residuals.png'
                    style="display:block;background-color:#FFFFFF;" width="100%" height="100%"
                    onclick='clickSize(this)'>
                </img-center>
            <space></space>
        <p>
            Ось абсцисс - элементы, отсортированные по суммарной площади первого и второго этажа <sb>grlivarea</sb>. Визуально этот график можно разбить на три составляющие: малые, средние и большие дома. Модель чаще переоценивает небольшие дома, значения ошибок при этом относительно невелики. На среднем отрезке ошибки увеличиваются и становятся более симметричными. Для больших домов вновь чаще наблюдается переоценка, а ошибки иногда превышают 50000$.
        </p>
        <h2>
            <a
                class='anchor'
                id='dataset_description'>
                </a>
            <i>Секция 1. Исследование и подготовка данных</i>
            </h2>
        <h2>
            2. Описание датасета
            </h2>
        <p>
            В проекте используется один из датасетов, опубликованных на Kaggle. Это задача регрессии, в которой требуется спрогнозировать стоимость дома, используя значения его характеристик и исторические данные о предыдущих сделках.
            <space></space>
        <a
            href='https://www.kaggle.com/competitions/house-prices-advanced-regression-techniques/overview'
            target='_blank'
            >Перейти к странице датасета на сайте Kaggle
            </a>
            <space></space>
            </p>
            <ul>
                <li>Число предикторов - 79;</li>
                <li>Число элементов - 1460.</li>
                </ul>
            <space20></space20>
            <img-center>
                <img 
                    src='img/Section1-Overview-and-Base-model/data_raw.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-center>
            <space20></space20>
        <p>
            Данные разбиваются на два датасета в соотношении 9 к 1: обучающий train (1314 элемента) и проверочный test (146 элемента).
            <space></space>
            </p>
        <h4>
            <i>Целевая переменная</i>
            </h4>  
        <p>
            Распределение целевой переменной напоминает гамма-распределение. Это одномодальное распределение с вершиной в районе 150000$ и правосторонней асимметрией.
            <space></space>
            <img src='img/Section1-Overview-and-Base-model/target_distribution.png'>
            <space></space>
            Для выравнивания формы распределения и снижения влияния экстремальных значений используется натуральный логарифм.
            <space></space>
            <img src='img/Section1-Overview-and-Base-model/target_distribution_log.png'>
            </p>
            <h4>
                <i>Характеристики</i>
                </h4>
        <p>
            В датасете 79 независимых переменных:
            </p>
            <ul>
                <li>Количественные признаки - 34;</li>
                <li>Категориальные признаки - 45:</li>
                <ul style='list-style-type:"-  ";'>
                    <li style='margin-left:-15px'>Порядковые - 18;</li>
                    <li style='margin-left:-15px'>Номинативные - 27.</li>
                    </ul>
            </ul>
        <h4>
            <i>Группы предикторов</i>
            </h4>
        <p>
            Для более детального анализа предикторы разделяются на группы. Этот подход полезен для генерации дополнительных признаков, являющихся производными от основных характеристик, а также для очистки и проверки данных на логические противоречия.
            <space></space>
            Сформировано 12 категорий предикторов:
            <ul>
                <li>Качество помещений и материалов;</li>
                <li>Относящиеся к гаражу;</li>
                <li>Относящиеся к подвалу;</li>
                <li>Предикторы, связанные с площадью;</li>
                <li>Типы помещений (комнаты, подвал);</li>
                <li>Год постройки дома/гаража, модернизации, и т.д.;</li>
                <li>Двор и область вокруг дома;</li>
                <li>Строительный материал;</li>
                <li>Конструкционные особенности;</li>
                <li>Состояние (уровень износа);</li>
                <li>Удобства;</li>
                <li>Окружение (район, улица, и т.д.);</li>
                <li>Организационные аспекты продажи.</li>
            </ul>
            </p>
        <h2>
            <a
                class='anchor'
                id='missed_values'>
                </a>
            3. Заполнение отсутствующих значений
            </h2>
        <h4>
            <i>Категориальные переменные</i>
            </h4>
        <p>
            Некоторые переменные содержат множество пропущенных значений. Иногда их количество достигает почти 100% от общего числа элементов.
            <space></space>
            <i>Порядковые</i>
            <space></space>
            <img-margin>
                <img 
                    src='img/Section1-Overview-and-Base-model/categorical_ordinal.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-margin>
            <space></space>
            <i>Номинативные</i>
            <space></space>
            <img-margin>
                <img
                    src='img/Section1-Overview-and-Base-model/categorical_categorical.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-margin>
            <space></space>
            Большое число пропусков объясняется тем, что большинство NaN в этом датасете эквивалентны значению "Отсутствует" (например, NaN для переменной "бассейн" означает, что в этом доме отсутствует бассейн). После замены NaNs на 'NA' остается только одно пропущенное значение в переменной <sb>electrical</sb>, которое заполняется медианой.
        </p>
        <h4>
            <i>Количественные переменные</i>
            </h4> 
        <p>            
            Пропущенные значения имеются у трех количественных переменных: <sb>lotfrontage</sb>, <sb>garageyrblt</sb>, <sb>masvnrarea</sb>.
            </p>
            <space20></space20>
            <img-margin>
                <img
                    src='img/Section1-Overview-and-Base-model/quantitative.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-margin>
            <space></space>
        <ul style='list-style-type:"a) ";margin-bottom:-10px'>
            <li><sb>lotfrontage</sb> - длина участка улицы, прилегающей к придомовой территории</li>
        </ul>
        <p style='margin-bottom:0px'>
            &emsp;&emsp;&ensp;237 (18%) пропусков заполняются медианным значением. Помимо этого, обнаружены два потенциальных выброса (выделены красным).
            <space></space>
            <img src='img/Section1-Overview-and-Base-model/lotfrontage_outs.png'>
            <space></space>
            </p>
        <ul style='list-style-type:"b) ";margin-bottom:-10px'>
            <li><sb>garageyrblt</sb> - год постройки гаража</li>
        </ul>
        <p style='margin-bottom:10px'>
            &emsp;&emsp;&ensp;73 (6%) пропусков заполняются годом постройки дома.
            </p>
        <ul style='list-style-type:"c) ";margin-bottom:-10px'>
            <li><sb>masvnrarea</sb> - площадь облицовки фундамента</li>
        </ul>
        <p style='margin-bottom:10px'>
            &emsp;&emsp;&ensp;8 (1%) пропусков. Более детальное изучение этой и связанных с ней переменных показывает, что все пропущенные значения соответствуют отсутствию облицовки (переменная <sb>masvnrtype</sb> со значением NA). Соответственно, площади этих элементов заполняются нулевыми значениями.
            </p>
        <h2>
            <a
                class='anchor'
                id='model_base'>
                </a>
            4. ML-модель №1 (базовая)
            </h2>
        <p>
            Алгоритм LightGBM используется в качестве базовой ML-модели, потому что он оптимален с точки зрения эффективности и производительности.    
            <space></space>
            Катеориальные признаки кодируются с помощью <sb>OrdinalEncoder</sb> из библиотеки Feature-engine (категории заменяются целыми числами - по возрастанию в зависимости от величины среднего значения целевой переменной для данной категории).
            <space></space>
            Подбор гиперпараметров проводится в два этапа. На первом этапе тестируется широкий диапазон значений и определяются базовые параметры. После этого осуществляется дополнительный поиск в окрестностях этих параметров. В обоих случаях используется <sb>GridSearch</sb> от Scikit-learn с <sb>20-fold</sb> кросс-валидацией.
            <space></space>
            Чтобы предотвратить утчеку данных применяется <sb>Pipeline</sb> от Scikit-learn.
            <space></space>
            Метрика качества модели - <sb>RMSE</sb> (среднеквадратичная ошибка).
            </p>
        <h4>
            <i>Результаты 1-го этапа подбора гиперпараметров</i>
            </h4> 
        <p>
            Лучшие результаты (RMSE примерно 0.130) показывают сложные модели с большим числом деревьев (75), увеличение числа листьев положительно сказывается на эффективности модели. Оптимальная скорость обучения - 0.1. RMSE лучшей модели - 0.1282.
            <space20></space20>
            <img-center>
                <img 
                    src='img/Section1-Overview-and-Base-model/gridsearch1.png'
                    style='display:block;background-color:#FFFFFF;'
                    onclick='clickSize(this)'>
                </img-center>
            <space></space>
            </p>
            <h4>
                <i>Результаты 2-го этапа подбора гиперпараметров</i>
                </h4> 
        <p>
            Ошибка уменьшилась незначительно - с 0.1282 до 0.1276.
            <space></space>
            <img-center>
                <img 
                    src='img/Section1-Overview-and-Base-model/gridsearch2.png'
                    style='display:block;background-color:#FFFFFF;'
                    onclick='clickSize(this)'>
                </img-center>
            <space></space>
            </p>
        <h4>
            <i>ML-модель №1 (базовая)</i>
            </h4>
        <p>
            Таким образом, базовая модель (RMSE: 0.1276) имеет следующую конфигурацию:
            <space></space>
            <img-center>
            <img src='img/Section1-Overview-and-Base-model/model_1.png'>
                </img-center>
            <space></space>
            Это первый ориентир, показывающий насколько хорошо имеющиеся данные подходят для прогнозирования цены дома. Также базовая модель дает представление о наиболее значимых предикторах. Можно отметить, что 7 из 10 ключевых предикторов связаны с площадью. На общем фоне заметно выделяется суммарная площадь первого и второго этажа (<sb>grlivarea</sb>).
            <space></space>
            <img src='img/Section1-Overview-and-Base-model/feature_importance.png'>
            <space></space>
        <h2>
            <a
                class='anchor'
                id='eda'>
                </a>
            5. Исследование данных
            </h2>
        <h4>
            <i>Матрица корреляций</i>
            </h4> 
        <p>
            В топ-10 в основном попали оценки площади и качества различных составляющих дома (см. рисунок ниже, клик для увеличения изображения).
            <img
                src='img/Section2-Explore-and-Clean/corr_matrix.png'
                style="display:block;background-color:#FFFFFF;" width="100%" height="100%"
                onclick='clickSize(this)'>
            <space20></space20>
            Полный набор визуализаций представлен в соответствующем блокноте <i>'Section2-Explore-and-Clean.ipynb'</i>. Ниже приведены несколько типовых графиков.
        </p>
        <h4>
            <i>Количественные признаки</i>
            </h4>
        <p>
            Ключевые инструменты для исследования количественных переменных - гистограммы и диаграммы рассеяния с добавлением линии регрессии.
            <space></space>
            <img
                src='img/Section2-Explore-and-Clean/quantitative.png'
                style="display:block;background-color:#FFFFFF;" width="100%" height="100%"
                onclick='clickSize(this)'>
            <space></space>
            </p>
        <h4>
            <i>Категориальные признаки</i>
            </h4>
        <p>
            Ключевые инструменты для исследования категориальных переменных - диаграмма рассеяния с линией регрессии и точечная диаграмма.
            <space></space>
            <img
                src='img/Section2-Explore-and-Clean/ordinal.png'
                style="display:block;background-color:#FFFFFF;" width="100%" height="100%"
                onclick='clickSize(this)'>
            <space></space>
            <img
                src='img/Section2-Explore-and-Clean/categorical.png'
                style="display:block;background-color:#FFFFFF;" width="100%" height="100%"
                onclick='clickSize(this)'>
            <space20></space20>
            Примеры взаимосвязи некоторых категориальных переменных с ценой.
            <space20></space20>
            <img src='img/Section2-Explore-and-Clean/housestyle.png'>
            <space></space>
            <img src='img/Section2-Explore-and-Clean/kitchenqual_vs_price.png'>
            <space></space>
            </p>
        <h2>
            <a
                class='anchor'
                id='clear'
                ></a>
            6. Очистка и проверка на несоответствие
            </h2>
        <h3>
            <a
                class='anchor'
                id='discrepancy'>
                </a>
            6.1. Проверка данных на несоответствие
            </h3>
        <p>
            В этом пункте данные проверяются на несоответствие, например, суммарная площадь жилого пространства не должна быть больше или меньше суммы площадей всех комнат.
            <space></space>
            Проверено 33 предиктора, несоответствия найдены в двух переменных: <sb>masvnrarea</sb> и <sb>garageyrblt</sb>.
            <space></space>
            <b> GARAGEYRBLT </b> (год постройки гаража) 
            <space></space>
            <i>Несоответствия:</i>
            </p>
            <ul>
                <li>У 6 элементов год постройки гаража меньше года постройки дома. В некоторых случаях эта разница составляет несколько лет.</li>
                </ul>
        <p>    
            <i>Возможная причина:</i>
            </p>
            <ul>
                <li>Постройка гаража может быть первым этапом строительства, но после её завершения возможна заморозка стройки, например, из-за финансовых трудностей. Соответственно, сам дом будет достроен только через несколько лет. Такое несоответствие допускается.</li>
                </ul>
        <p>
            <i>Решение:</i>
            </p>
            <ul>
                <li>Данные не исправляются.</li>
                </ul>
        <p>
            <b> MASVNRAREA </b> (Площадь облицовки фундамента)
            <space20></space20>
            <img-margin>
                <img
                    src='img/Section2-Explore-and-Clean/masvnarea_disc.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-margin>
            <space></space>
            <i>Несоответствия:</i>
            </p>
             <ul>
                <li>У 7 элементов площадь облицовки равна 0 (эквивалентно тому, что облицовка отсутствует), при этом тип облицовки не равен NA; и наоборот (см. таблицу выше).</li>
                </ul>
        <p>
            <i>Возможная причина:</i>
            </p>
            <ul>
                <li><t>Ошибка ввода данных.</t></li>
                </ul>
        <p>
            <i>Решение:</i>
            </p>
            <ul>
                <li>Исправление вручную. Во время исправления ошибок будем ориентироваться на тип облицовки (<sb>masvnrtype</sb>) и цену дома (<sb>price</sb>). На графике видно, что наиболее дорогие - это дома с облицовкой из камня (Stone) и кирпича (BrkFace).</li>
                </ul>
            <space></space>
            <img src='img/Section2-Explore-and-Clean/masvnrtype_price.png'>
            <space></space>
        <p>
            В данных имеется три различных типа противоречий, и соответственно, будут исследованы три группы элементов.
            </p>
        <h4>
            <i>Элементы с индексом 1230 и 733</i>
            </h4>
            <space></space>
            <img-margin>
                <img
                    src='img/Section2-Explore-and-Clean/1230_773.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-margin>
            <space></space>
        <p>
        <i>Противоречие:</i>
            </p>
        <ul>
            <li>Если <sb>masvnrtype</sb> равен NA, то <sb>masvnrarea</sb> должна быть равна 0.</li>
            </ul>
        <p>
            <i>Варианты исправления:</i>
            </p>
            <ul>
                <li>Или <sb>masvnrtype</sb> присваивается какое-то значение, или <sb>masvnrarea</sb> приравнивается к 0.</li>
                </ul>
        <p>
            <i>Решение:</i>
            </p>
            <ul>
                <li><sb>masvnrarea</sb> приравнивается к 0.</li>
                </ul>
        <p>
            <i>Аргументы:</i>
            </p>
            <ul>
            <li>Цены этих домов примерно равны 12.0 - это может говорить о том, что облицовка отсутствует (средняя цена домов без облицовки - 11.9).</li>
            <li>Самое низкое значение переменной <sb>masvnrarea</sb> - 10 (см. график ниже); вероятно, 1 - это ошибка ввода данных.</li>
                </ul>
            <space></space>
            <img src='img/Section2-Explore-and-Clean/masvnrarea_minimal.png'>
            <space></space>
        <h4>
            <i>Элементы с индексом 1241 и 688</i>
            </h4>
            <space></space>
            <img-margin>
                <img
                    src='img/Section2-Explore-and-Clean/688_1241.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-margin>
            <space></space>
        <p>
            <i>Противоречие:</i>
            </p>
             <ul>
                <li>Если <sb>masvnrarea</sb> равна нулю, то <sb>masvnrtype</sb> должен быть равен NA.</li>
                </ul>
        <p>
            <i>Варианты исправления:</i>
            </p>
             <ul>
                <li>Или <sb>masvnrarea</sb> присваивается какое-либо значение, или <sb>masvnrtype</sb> меняется на NA.</li>
                </ul>
        <p>
            <i>Решение:</i>
            </p>
            <ul>
                <li><sb>masvnrarea</sb> присваивается медианное значение элементов, у которых такой же тип облицовки <sb>masvnrtype</sb>.</t></li>
                </ul>
        <p>
            <i>Аргументы:</i>
            </p>
            <ul>
                <li>Цена элементов с нулевой <sb>masvnrarea</sb> достаточно большая, что говорит скорее в пользу наличия облицовки (т.е. в пользу того, что <sb>masvnrarea</sb> не равна нулю), поэтому <sb>masvnrarea</sb> заполняется медианным значением.</li>
                </ul>
        <h4>
            <i>Элементы с индексом 624, 1300 и 1334</i>
            </h4>
            <space></space>
            <img-margin>
                <img
                    src='img/Section2-Explore-and-Clean/624_1300_1334.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-margin>
            <space></space>
        <p>
            <i>Противоречие:</i>
            </p>
            <ul>
                <li>Если <sb>masvnrarea</sb> не равна нулю, то <sb>masvnrtype</sb> не должен быть NA.</li>
                </ul>
        <p>
            <i>Варианты исправления:</i>
            </p>
            <ul>
                <li>Или <sb>masvnrtype</sb> присваивается какое-то значение, или <sb>masvnrarea</sb> приравнивается к 0.</li>
                </ul>
        <p>
            <i>Решение:</i>
            </p>
            <ul>
                <li>Элементы 624 и 1334: <sb>masvnrarea</sb> приравнивается к 0;</li>
                <li>Элемент 1300: <sb>masvnrtype</sb> присваивается значение Stone.</li>
                </ul>
        <p>
            <i>Аргументы:</i>
            </p>
            <ul>
                <li>Для всех трех элементов выбор сделан исходя из их цены - у дорогих домов чаще встречается <sb>masvnrtype</sb>, равный Stone, а у недорогих - NA.</li>
                </ul>
        <h4>
            <i>Исправленные данные</i>
            </h4>
            <space></space>
            <img-margin>
                <img
                    src='img/Section2-Explore-and-Clean/masvnrarea_fixed.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-margin>
            <space></space>
        <h3>
            <a
                class='anchor'
                id='outliers'>
                </a>
            6.2. Выявление и удаление выбросов
            </h3>
        <p>
            Два подозрительно высоких значения <sb>lotfrontage</sb>, обнаруженных при исследовании количественных признаков.
            <space></space>
            <img src='img/Section2-Explore-and-Clean/lotfrontage.png'>
            <space></space>
            Потенциальные выбросы обнаружены также в некоторых других переменных. Например, так выглядит диаграмма для переменной <sb>miscval</sb>:
            <space></space>
            <img src='img/Section2-Explore-and-Clean/miscval.png'>
            <space></space>
            Далее строятся диаграммы, на которых подозрительные элементы выделены цветом.
            <space></space>
            <img 
                src='img/Section2-Explore-and-Clean/outliers_colored.png'
                style="display:block;background-color:#FFFFFF;" width="100%" height="100%"
                onclick='clickSize(this)'>
            <space></space>
            После визуальной оценки три элемента (индексы 523, 934 и 1298) признаются выбросами и удаляются из датасета.
            </p>
        <h2>
            <a
                class='anchor'
                id='model_inter1'>
                </a>
            7. ML-модель №2 (после очистки данных)
            </h2>
        <p>
            Здесь применяется тот же двухэтапный подход, который использовался в пункте <i>"4. ML-модель №1 (базовая)"</i>. Лучшая модель демонстрирует RMSE на уровне 0.1233 (у базовой модели RMSE равна 0.1276). Конфигурация модели выглядит следующим образом:
            <space></space>
            <img-center>
            <img src='img/Section2-Explore-and-Clean/model_2.png'>
                </img-center>
            <space></space>
            По сравнению с базовой моделью число деревьев не изменилось, глубина дерева уменьшилась почти в три раза, а количество листьев сократилось более чем в 10 раз. Значимость предикторов выровнялась по сравнению с сырыми данными. По-прежнему лидирует предиктор, характеризующий суммарную площадь первого и второго этажа <sb>grlivarea</sb>.
            </p>
            <space></space>
            <img src='img/Section2-Explore-and-Clean/feature_importance.png'>
            <space></space>
        <h4>
            <i>Промежуточные результаты</i>
            </h4>
        <p>
            После очистки и исправления данных модель стала проще и эффективнее. 
            </p>
            <space></space>
            <img src='img/Section8-Final-predictions/results_inter1.png'>
            <space></space>
            </p>
        <h2>
            <a
                class='anchor'
                id='feature_engineering'>
                </a>
            8. Создание дополнительных предикторов.
            </h2>
        <p>
            На данном этапе предикторы разбиваются на <sb>группы</sb> и исследуется возможность создания дополнительных предикторов, которые могут улучшить модель.
            </p>
        <h3>
            <a
                class='anchor'
                id='square_feet'>
                </a>
            8.1. Предикторы, характеризующие площадь.
            </h3>
        <p>
            Исследовано 17 предикторов, создан 1 дополнительный - <sb>flsrmean</sb>.
            <space></space>
            Согласно матрице корреляций наиболее информативным предиктором в данной группе является суммарная площадь первого и второго этажа <sb>grlivarea</sb> с коэффициентом корреляции 0.72 (для очищенных данных). Этот показатель эквивалентен их среднему арифметическому.
            <space></space>
            Гипотеза, лежащая в основе создания нового предиктора <sb>flrsfmean</sb>: для большинства жителей относительная ценность первого этажа выше, чем второго. Объясняется это тем, что на втором этаже расположены преимущественно спальни, и люди в целом проводят больше времени на первом этаже. Чтобы учесть этот эффект, вместо среднего арифметического будет использоваться среднее взвешенное:
            </p>
            <space></space>
            \[ flrsfmean = \frac{first\_flrsf*weight_1 + second\_flrsf*weight_2}{weight_1 + weight_2} , \]
            <space></space>
            <p>
                где  \( weight_1 \) и \( weight_2 \) - это вес первого и второго этажа соответственно.
                </p>
            <space></space>
            <p>
                После нескольких тестов веса принимаются равными 1 и 0.7, соответственно. Итоговая формула выглядит следующим образом:
                </p>
            <space></space>
            $$ flrsfmean = \frac{first\_flrsf + second\_flrsf*0.7}{1.7} $$
            <space></space>
            <p>
                Коэффициент корреляции нового предиктора <sb>flrsfmean</sb> равен 0.77. Это на 0.05 выше, чем у наиболее информативного количественного предиктора <sb>grlivarea</sb>. Также <sb>flrsfmean</sb> имеет мéньшую дисперсию.
                </p>
            <space></space>
            <img-center><img src='img/Section3-Feature-selection-and-Preprocessing/flrsfmean.png'></img-center>
            <space></space>
        <h3>
            <a
                class='anchor'
                id='rooms'>
                </a>
            8.2. Предикторы, характеризующие помещения (жилые и ванные комнаты, кухни).
            </h3>
        <p>
            Исследовано 7 предикторов, создано 5 дополнительных - <sb>bedroomsize</sb>, <sb>kitchensize</sb>, <sb>bedroomfracrms</sb>, <sb>kitchenfracrms</sb>, <sb>bathsfracbedr</sb>. Новые предикторы можно разделить на три группы:
            </p>
            <ul>
            <li><sb>bedroomsize</sb>, <sb>kitchensize</sb>: относительное количество спален и кухонь по площади - рассчитывается как количество спален/кухонь, деленное на суммарную площадь первого и второго этажа (<sb>grlivarea</sb>);</li>
            <li><sb>bedroomfracrms</sb>, <sb>kitchenfracrms</sb>: относительное количество спален и кухонь по общему числу комнат - рассчитывается как количество спален/кухонь, деленное на общее число комнат (<sb>totrmsabvgrd</sb>);</li>
            <li><sb>bathsfracbedr</sb>: относительное число ванных комнат на спальню - рассчитывается как число совмещенных ванных комнат, деленное на число спален (<sb>bedroomabvgr</sb>).</li>
                </ul>
        <p>
            Наиболее информативным из новых признаков является относительное число кухонь (<sb>kitchensize</sb>, коэффициент корреляции: -0.71).
            </p>
            <space></space>
            <img-center><img src='img/Section3-Feature-selection-and-Preprocessing/bedroom_kitchen.png'></img-center>
            <space></space>
        <h3>
            <a
                class='anchor'
                id='dates'>
                </a>
            8.3. Предикторы, характеризующие даты.
            </h3>
        <p>
            Добавлены новые предикторы <sb>houseage</sb> (возраст дома на момент продажи) и <sb>modage</sb> (число лет с момента модернизации на момент продажи). Они не повышают информативность, но лучше подходят для интерпретации.
            </p>
        <h2>
            <a
                class='anchor'
                id='preprocessing'>
                </a>
            9. Предварительная подготовка данных
            </h2>
         <p>
            <i>Данные до преобразования</i>
            <space></space>
            <img-center>
                <img
                    src='img/Section3-Feature-selection-and-Preprocessing/data_raw.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-center>
            <space></space>
             </p>
        <h4>
            <i>Количественные переменные</i>
            </h4>
        <p>
            Количественные предикторы логарифмируются (натуральный логарифм) с помощью <sb>LogCpTransformer</sb> из библиотеки Feature-engine. Предварительно к каждому значению добавляется константа C, равная 1. В название всех логарифмированных предикторов добавляется приставка <sb>lg_</sb>.
            <space></space>
            <img-center>
                <img
                    src='img/Section3-Feature-selection-and-Preprocessing/data_log.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-center>
            <space></space>
            Матрица корреляций после добавления новых предикторов и логарифмирования приведена ниже. Единственный признак, отрицательно коррелирующий с целевой переменной - относительное число кухонь <sb>kitchensize</sb>.
            <space></space>
            <img-center>
                <img 
                    src='img/Section3-Feature-selection-and-Preprocessing/corr_matrix_new.png'
                    style="display:block;background-color:#FFFFFF;"
                    onclick='clickSize(this)'>
                </img-center>
            <space></space>
            </p>
        <h4>
            <i>Категориальные переменные</i>
            </h4>
        <p>
            Для преобразования категориальных переменных используется <sb>OrdinalEncoder</sb> из библиотеки Feature-engine. Он присваивает переменным порядковые целочисленные значения (0, 1, 2, 3, и т.д.). Порядок определяется средним значением целевой переменной (0 - для элементов с наименьшим средним и далее по возрастанию).
            <space></space>
            <img-center>
                <img
                    src='img/Section3-Feature-selection-and-Preprocessing/data_encoded.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-center>
            <space></space>
            </p>
        <h4>
            <i>Стандартизация</i>
            </h4>
        <p>
            После этого данные стандартизируются с помощью <sb>StandardScaler</sb> из библиотеки Scikit-learn.
            <space></space>
            <img-center>
                <img
                    src='img/Section3-Feature-selection-and-Preprocessing/data_scaled.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-center>
            <space></space>
            </p>
        <h2>
            <a
                class='anchor'
                id='model_inter2'>
                </a>
            10. ML-модель №3 (после создания новых признаков)
            </h2>
        <p>
            Добавление новых предикторов почти не повлияло на эффективность модели (RMSE уменьшилась с 0.1233 до 0.1230). Число деревьев увеличилось на 10, глубина деревьев увеличилась в два раза, а число листьев не изменились.
            <space></space>
            <img-center>
            <img src='img/Section3-Feature-selection-and-Preprocessing/model_3.png'>
                </img-center>
            <space></space>
             Теперь самым информативным предиктором является вновь созданный <sb>flrsfmean</sb> (это соответствует его высокому коэффициенту корреляции). В топ-10 наиболее значимых признаков также попал новый предиктор <sb>bedroomsize</sb>.
            <space></space>    
            <img src='img/Section3-Feature-selection-and-Preprocessing/feature_importance.png'>
            <space></space>
            </p>
        <h4>
            <i>Промежуточные результаты</i>
            </h4>
        <p>
            Дисперсия результатов модели после добавления новго предиктора несколько увеличилась при том, что эффективность осталась на прежнем уровне. 
            </p>
            <space></space>
            <img src='img/Section8-Final-predictions/results_inter2.png'>
            <space></space>
            </p>
        <h2>
            <a
                class='anchor'
                id='elastic_net'>
                </a>
            <i>Секция 2. Регрессионный анализ</i>
            </h2>
        <h2>
            11. Эластичная сеть
            </h2>
        <p>
            В этом пункте строится эластичная сеть, оценивается влияние регуляризации на эффективность и исследуется, какие предикторы выбирает сеть в зависимости от величины параметра регуляризации.
            <space></space>
            Пространство значений гиперпараметра \( \alpha \) выглядит следующим образом.
            <space></space>
            <img src='img/Section4-Linear-models-research/alphas_logspace.png'>
            <space></space>
            Отобразим зависимость эффективности модели от величины \( \alpha \), а также добавим на верхнюю ось число предикторов эластичной сети. 
            <space></space>
            <img src='img/Section4-Linear-models-research/features_plot.png'>
            <space></space>
            Чем ниже параметр регуляризации, тем выше эффективность прогнозирования (оптимальный \( \alpha \) равен 0.0067). Минимальное число предикторов эластичной сети - 3, это <sb>lg_flrsfmean</sb>, <sb>neighborhood</sb>, <sb>overallqual</sb>. Ошибка резко уменьшается после увеличения количества предикторов с 3 до 8, заметно снижается при изменении их с 8 до 33, и плавно снижается после увеличения до 88. 
            <space></space>
            С точки зрения баланса точности прогнозов и интерпретируемости модели, оптимальное количество предикторов находится между 8 и 33. Необходимо также учитывать тот факт, что после отметки в 14 признаков показатель мультиколлинеарности <sb>VIF</sb> увеличивается многократно и выходит за допустимые рамки (см. таблицу ниже). 
            <space></space>
            <i>Изменение набора предикторов в зависимости от величины параметра регуляризации \( \alpha \)</i>
            <space></space>
            <img-center>
                <img
                    src='img/Section4-Linear-models-research/features_by_alpha.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-center>
            <space></space>
            В следующем пункте строится линейная регрессия, которая станет ядром HousePricePredictor.
            </p>
        <h2>
            <a
                class='anchor'
                id='linear_regression'>
                </a>
            12. Линейная регрессия
            </h2>
        <p>
            Предикторы должны соответствовать следующим требованиям:
            </p>
        <ul>
            <li>Они удобны в интерпретации и понятны любому пользователю;</li>
            <li>Они входят в состав наиболее информативных предикторов эластичной сети;</li>
            <li>Они статистически значимы на уровне \( \alpha \), равном 0.05;</li>
            <li>Включение дополнительного признака в модель увеличивает скорректированный коэффициент детерминации \( R^{2}_{adj} \).</li>
            </ul>
        <p>
            В итоге выбраны следующие предикторы:
            </p>
        <ul>
            <li><sb>lg_flrsfmean</sb> - средневзвешенная площадь этажей;</li>
            <li><sb>lg_lotarea</sb> - площадь придомовой территории;</li>
            <li><sb>overallqual</sb> - оценка качества дома;</li>
            <li><sb>kitchenqual</sb> - оценка качества кухни;</li>
            <li><sb>exterqual</sb> - оценка качества материала фасада;</li>
            <li><sb>bsmtqual</sb> - оценка качества подавала;</li>
            <li><sb>overallcond</sb> - оценка состояния дома;</li>
            <li><sb>houseage</sb> - возраст дома на момент продажи;</li>
            <li><sb>garagecars</sb> - количество машиномест в гараже.</li>
                </ul>
        <p>
            Для повышения надежности оценки доверительных интервалов коэффициентов используется метод HC3, устойчивый к гетероскедастичности.
            <space></space>
            <i>Коэффициенты регрессии</i>
            <space></space>
            <img-center>
                <img
                    src='img/Section4-Linear-models-research/coefficients_table_charachteristics.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-center>
            <space></space>
            </p>
        <h4>
            <i>Оценка качества регрессии</i>
            </h4>
        <p>
            <i>Визуальная оценка</i>
            </p>
            <space></space>
            <img-center>
                <img 
                    src='img/Section4-Linear-models-research/regression_diagnostics.png'
                    style="display:block;background-color:#FFFFFF;" width="100%" height="100%"
                    onclick='clickSize(this)'>
                </img-center>
        <p>
            <space></space>
            <i>Результаты статистических тестов и характеристики регрессии</i>
            <space20></space20>
            <img-margin>
                <img
                    src='img/Section4-Linear-models-research/regression_tests.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-margin>
            <space></space>
            Скорректированный коэффициент детерминации \( R^{2}_{adj} \) значим и равен 0.882.
            <space></space>
            Согласно статистическим тестам у нас недостаточно оснований утверждать, что в регрессию включены все предикторы, оказывающие влияние на целевую переменную, а также отсутствуют нелинейные взаимосвязи (тест Ramsey, нелинейность остатков). Автокорреляция остатков и мультиколлинеарность не выявлены, гетероскедастичность остатков нивелируется поправкой HC3. 
            <space></space>
            Попробуем удалить крайние элементы остатков ( \( 1.5*IQR \) ), повторить тесты на нормальность и эксцесс, а также построим график, на котором нормальное распределение с параметрами остатков ( \( mean \) 0, \( std.\) ~0.1243) сравнивается с распределением остатков до и после удаления выбросов. 
            <space></space>
            <i>Тесты на нормальность распределения остатков без выбросов</i>
            <space></space>
            <img-margin>
                <img
                    src='img/Section4-Linear-models-research/residuals_trimmed_tests.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-margin>
            <space></space>
            <i>Коэффициент эксцесса</i>
            <space></space>
            <img-margin>
                <img
                    src='img/Section4-Linear-models-research/residuals_kurtosis.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-margin>
            <space></space>
            <i>Визуализация формы распределения остатков и сравнение с нормальным распределением</i>
            <space></space>
            <img src='img/Section4-Linear-models-research/residuals_distributions_comparing.png'>
            <space></space>
            Теперь остатки распределены нормально, и в целом форма остатков без удаления выбросов отличается от формы нормального распределения с заданными параметрами только наличием хвостов, что сказывается и на величине эксцесса. Возможно, структура цены нескольких элементов выбивается из общей картины - можно предположить сознательное снижение/завышение цены при продаже дома.
            </p>
        <h4>
            <i>Интерпретация коэффициентов</i>
            </h4>  
        <p>
            Все оценки действительны при прочих равных:
            </p>
            <ul>
                <li><sb>lg_flrsfmean</sb> - при увеличении средневзвешенной площади этажей на 1%, цена увеличивается на 0.144%;</li>
                <li><sb>overallqual</sb> - при увеличении качества материалов на 1 пункт, цена увеличивается на 8.8%;</li>
                <li><sb>houseage</sb> - при увеличении возраста дома на 1 год цена уменьшается на 8.5%;</li>
                <li><sb>lg_lotarea</sb> - при увеличении площади придомовой территории на 1%, цена увеличивается на 0.0613%;</li>
                <li><sb>overallcond</sb> - при увеличении оценки состояния дома на 1 пункт, цена увеличивается на 5.58%;</li>
                <li><sb>bsmtqual</sb> - при увеличении оценки качества подавала на 1 пункт, цена увеличивается на 4.59%;</li>
                <li><sb>garagecars</sb> - при увеличении количество машиномест на 1 единицу, цена увеличивается на 3.16%;</li>
                <li><sb>kitchenqual</sb> - при увеличении оценки качества кухни на 1 пункт, цена увеличивается на 2.66%;</li>
                <li><sb>exterqual</sb> - при увеличении оценки качества материала фасада на 1 пункт, цена увеличивается на 2.03%;</li>
                </ul>
        <h4>
            <i>Вывод</i>
            </h4>
        <p>
            Линейная регрессия объясняет 88% изменчивости целевой переменной, что является хорошим результатом. Используемые предикторы значимы, понятны и легко интерпретируемы. Тем не менее, модель не в полной мере соответствует имеющимся данным. Это объяснимо, если учесть тот факт, что не были использованы некоторые важные признаки (<sb>neighborhood</sb>, <sb>functional</sb>).
            </p>
        <h2>
            <a
                class='anchor'
                id='simulations'>
                </a>
            13. Результаты линейных моделей на сэмплированных данных
            </h2>
         <p>
            Сгенерированные с помощью симуляций подвыборки не содержат дополнительной информации. Тем не менее, если предположить, что исходный датасет достаточно точно отражают генеральную совокупность, результаты симуляций могут быть полезны для оценки дисперсии прогнозов. Симуляции проводились на 1000 сэмплах с повторением (число элементов в сэмпле и исходных данных одинаково).
            <space></space>
            RMSE по результатам симуляции:
            </p>
            <ul>
                <li>линейная регрессия из п.12 - 0.1352;</li>
                <li>эластичная сеть (alpha: 0.0067, L1 ratio: 0.1) - 0.1347.</li>
                </ul>
            <space20></space20>
            <img-center><img src='img/Section4-Linear-models-research/simulations.png'></img-center>
            <space></space>
        <p>
            Прогнозы отдельно взятых элементов практически не различаются (что показывают предиктивные интервалы). Однако на длинной дистанции (для бóльшего числа элементов) в среднем эффективность эластичной сети выше, поэтому она будет включена в итоговое сравнение как наиболее эффективная регрессия.
            </p>
        <h4>
            <i>Промежуточные результаты</i>
            </h4>
        <p>
             По предсказательной точности регрессионная модель заметно уступает ML-алгоритмам, но при этом имеет мéньшую дисперсию прогнозов. 
            </p>
            <space></space>
            <img src='img/Section8-Final-predictions/results_inter3.png'>
            <space></space>
            </p>
        <h2>
            <a
                class='anchor'
                id='ml_algorithms'>
                </a>
            <i>Секция 3. Машинное обучение</i>
            </h2>
        <h2>
            14. Выбор алгоритма машинного обучения для прогнозирования остатков линейной регрессии
            </h2>
        <p>
            В этом разделе выбирается алгоритм для прогнозирования остатков линейной регрессии (п.14.1., п.14.2., п.14.3.). После этого создается модель <sb>HousePricePredictor</sb>, который объединяет линейную регрессию и оценщик остатков (14.4.).
            <space></space>
            Категориальные признаки кодируются с помощью <sb>OrdinalEncoder</sb> из библиотеки Feature-engine. Он присваивает переменным порядковые целочисленные значения (0, 1, 2, 3, и т.д.). Порядок определяется средним значением целевой переменной (0 - для элементов с наименьшим средним и далее по возрастанию).
            <space></space>
            Подбор гиперпараметров осуществляется с помощью решетчатого поиска <sb>GridSearch</sb> от Scikit-learn с <sb>20-fold</sb> кросс-валидацией. Чтобы предотвратить утчеку данных используется <sb>Pipeline</sb> от Scikit-learn.
            <space></space>
            Метрика качества модели - <sb>RMSE</sb> (среднеквадратичная ошибка).
            <space></space>
            </p>
        <h3>
            <a
                class='anchor'
                id='ml_simple'>
                </a>
            14.1. Опорные вектора, бустинги, бэггинг, случайный лес, K-ближайших соседей
            </h3>
         <p>
            На первом этапе обучаются следующие ML-модели:
            </p>
            <ul>
                <li><sb>KNN</sb> - K-Nearest Neighbors;</li>
                <li><sb>SVR</sb> - Support Vector Machine;</li>
                <li><sb>RF</sb> - Random Forest;</li>
                <li><sb>Bagging</sb> - Bagging Regressor;</li>
                <li><sb>LGBoost</sb> - Light Gradient Boosting;</li>
                <li><sb>HGBoost</sb> - Histogram-based Gradient Boosting;</li>
                <li><sb>XGBoost</sb> - Extreme Gradient Boosting.</li>
                </ul>
        <p>
            В качестве предикторов используются все сгенерированные в предыдущих пунктах признаки, а также прогнозы линейной регрессии (предиктор <sb>price_pred_lr</sb>).
            <space></space>
            Алгоритмы <sb>Random Forest</sb>, <sb>Bagging</sb>, <sb>LGBoost</sb>, <sb>XGBoost</sb> имеют встроенный функционал отбора наиболее информативных признаков. Отобразим топ-10 наиболее важных признаков для каждой из моделей.
            <space></space>       
            <img-margin>
                <img
                    src='img/Section5-Residuals-prediction/features_importance_four_models.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-margin>
            <space></space>
            Наиболее значимые признаки здесь:
            <space></space>
        <ul>
            <li><sb>neighborhood</sb> - район расположения дома, он вошел в топ-4 ключевых признаков каждой из моделей;</li>
            <li><sb>lg_bsmtfinsf_first</sb> - площадь подвала 1 типа, 3 модели поместили его в топ-4 ключевых признаков;</li>
            <li><sb>price_pred_lr</sb> - также в топ-4 у трех моделей, но менее значим, чем <sb>lg_bsmtfinsf_first.</sb></li>
            </ul>
        <p>
            <i>Число попаданий в топ-10 ключевых признаков</i>
            </p>
            <space></space>
            <img src='img/Section5-Residuals-prediction/features_importance.png'>
            <space></space>
        <p>
            Результаты на 20-фолдовой кросс-валидации выглядят следующим образом (опорные вектора демонстрируют неожиданно высокий результат).
            <space></space>
            <img-center>
                <img
                    src='img/Section5-Residuals-prediction/models_residuals.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-center>
            <space></space>
            </p>
        <h3>
            <a
                class='anchor'
                id='vote_stack'>
                </a>
            14.2. Добавление метаоценщиков верхнего уровня - алгоритмы Voting и Stacking
            </h3>
        <p>
            На втором этапе оценивается эффект от поочередного включения в модель оценщиков верхнего уровня.
            <space></space>
            <b>VoteRegressor</b>
            <space></space>
            VoteRegressor формирует свой прогноз, усредняя прогнозы моделей нижнего уровня. Средняя RMSE на 20-фолдовой проверке составила 0.1101.
            <space></space>
            <b>StackingRegressor</b> 
            <space></space>
            В схеме StackingRegressor на верхний уровень добавляется агрегирующий оценщик (в данном случае это <sb>Ridge Regression</sb>), который выдает прогнозы, используя в качестве предикторов прогнозы моделей нижнего уровня. Средняя RMSE на 20-фолдовой проверке: 0.1084.
            <space></space>
            <b>Сравнение Voting и Stacking (20-fold cross-validation)</b>
            <space></space>
            Прогнозы <sb>Stacking</sb> точнее в 12 фолдах из 20.
            <space></space>
            <img-center>
                <img 
                    src='img/Section5-Residuals-prediction/vote_stack_compare.png'
                    style="display:block;background-color:#FFFFFF;"
                    onclick='clickSize(this)'>
            </img-center>
        <h3>
            <a
                class='anchor'
                id='residuals_final'>
                </a>
            14.3. Сравнение всех ML-алгоритмов и выбор оценщика остатков регрессии
            </h3>
        <p>
            Суммарные результаты всех обученных в этом разделе моделей выглядят следующим образом
            <space></space>
            <img-center>
                <img
                    src='img/Section5-Residuals-prediction/models_residuals_summary.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-center>
            <space></space>
            <i>Визуализация результатов</i>
            <space></space>
            <img-margin>
                <img src='img/Section5-Residuals-prediction/final_plot.png'>
                </img-margin>
            <space></space>
            Для оценки остатков будет использоваться алгоритм <sb>Stacking</sb>. 
            <space></space>
            <i>Конфигурация StackingRegressor</i>
            <space></space>
            <img 
                src='img/Section5-Residuals-prediction/stacking_cofiguration.png'
                style="display:block;" width="100%" height="100%">
            </p>
        <h3>
            <a
                class='anchor'
                id='hpp'>
                </a>
            14.4. Объединение линейной регрессии и ML-алгоритма в итоговый оценщик HPP
            </h3>
        <p>
            Класс <sb>HousePricePredictor</sb> объединяет линейную регрессию и Stacking в единую модель. Линейная регрессия генерирует основные прогнозы цен, а Stacking используется для коррекции и повышения точности.
            <space></space>
            <img-margin>
                <img
                    src='img/Section5-Residuals-prediction/hpp.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-margin>
            <space></space>
            <sb>HousePricePredictor</sb> поддерживает Scickit-learn-совместимые методы <sb>.fit</sb> и <sb>.predict</sb>, а также ряд других методов (код доступен в файле <i>tools.py</i>)
            <space></space>
            <img-margin>
                <img
                    src='img/Section5-Residuals-prediction/fit.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-margin>
            <space></space>
            <img-margin>
                <img
                    src='img/Section5-Residuals-prediction/predict.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-margin>
            <space></space>
            Средняя RMSE на 20-фолдовой проверке: 0.1102 +/- 0.009.
            </p>
        <h2>
            <a
                class='anchor'
                id='ml_models'>
                </a>
            15. Обучение независимых ML-моделей
            </h2>
        <p>
            Здесь, как и в предыдущем пункте, в первую очередь обучаются популярные ML-алгоритмы, а после этого исследуется влияние оценщиков верхнего уровня <sb>Voting</sb> и <sb>Stacking</sb>.
            <space></space>
            Отдельно оценивается вклад предикторов, добавленных в пункте <i>'8. Создание дополнительных предикторов'</i>.
            <space></space>
            <i>Визуализация результатов</i>
            <space></space>
            <img-margin><img src='img/Section7-ML-models/ml_models_plot.png'></img-margin>
            <space></space>
            <i>Средние значения RMSE (20-fold) всех моделей</i>
            <space></space>
            <img-center>
                <img
                    src='img/Section7-ML-models/ml_models_table.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-center>
            <space></space>
            Ожидаемо, наиболее эффективным алгоритмом оказался <sb>Stacking</sb>. Его конфигурация идентична модели, выбранной для прогнозирования остатков регрессии.
            <space></space>
            <img 
                src='img/Section7-ML-models/stacking_cofiguration.png'
                style="display:block;" width="100%" height="100%">
            <space></space>
            </p>
        <h4>
            <i>Промежуточные результаты</i>
            </h4>
        <p>
             Для итогового сравнения выбраны две ML-модели: стэкинг (наиболее эффективный) и SVM (лучший линейный алгоритм).
            </p>
            <space></space>
            <img src='img/Section8-Final-predictions/results_inter4.png'>
            <space></space>
            </p>
        <h2>
            <a
                class='anchor'
                id='comparison'>
                </a>
            <i>Секция 4. Подведение итогов</i>
            </h2>
        <h2>
            16. Сравнение всех моделей
            </h2>
        <p>
            В данном пункте оценщик HousePricePredictor сравнивается с моделями из предыдущих пунктов. Три базовых модели LightGBM обучены на разных этапах подготовки данных (удаление пропусков, очистка, генерация дополнительных признаков). Для обучения регрессионной модели (эластичная сеть) используются те же предикторы, которые были использованы для линейной регрессии в HousePricePredictor. Две ML-модели представляют лучшую линейную (SVM) ML-модель и лучший ансамблевый алгоритм (Stacking).
            </p>
        <ul style='padding-top:10px'>
            <li><sb>Base</sb> - базовая модель (LightGBM) после удаления пропусков;</li>
            <li><sb>Base (Clean)</sb> - промежуточная модель (LightGBM) после очистки данных;</li>
            <li><sb>Base (FE)</sb> - промежуточная модель (LightGBM) после генерации новых признаков;</li>
            <li><sb>Elastic Net</sb> - лучшая регрессионная модель (эластичная сеть);</li>
            <li><sb>SVM</sb> - лучшая линейная модель (SVM);</li>
            <li><sb>Stacking</sb> - лучший ансамблевый алгоритм (Stacking);</li>
            <li><sb>HPP</sb> - сочетание линейной регрессии и стэкинга (HousePricePredictor).</li>
            </ul>
        <p>
            <i>Сводный график и таблица с результатами</i>
            <space></space>
            <img 
                src='img/Section8-Final-predictions/final_plot.png'
                style='background-color:#FFFFFF;'
                onclick='clickSize(this)'>
            <space></space>
            <img
                src='img/Section8-Final-predictions/final_table_T.png'
                style='margin-left:80px;border: 1px solid #CCCCCC;border-radius: 3px;'>
            <space></space>
            Комментарии:
            </p>
        <ul>
            <li>Результат комбинирования линейной регрессии и алгоритмов машинного обучения превысил ожидание. Итоговый оценщик не только не уступает лучшей модели, но и превосходит её в точности;</li>
            <li>Очистка и исправление данных увеличили прогнозную точность базовой модели и уменьшили доверительный интервал;</li>
            <li>Генерация новых признаков сказалась на конфигурации базовой модели, но не на точности прогнозов (при этом неправильно утверждать, что новые признаки бесполезны - они использовались другими моделями, в частности линейной регрессией HousePricePredictor);</li>
            <li>Эластичная сеть ожидаемо продемонстрировала худшие результаты (что во многом связано с ограниченным числом предикторов в этой модели);</li>
            <li>Опорные вектора (SVM) неожиданно продемонстрировали сравнительно хорошие результаты. По эффективности этот алгоритм уступил только стэкингу (Stacking). Можно предположить, что это обусловлено высоким уровнем линейности взаимосвязей в данных;</li>
            <li>Stacking и HPP показывают хорошую кучность (это видно на нижнем графике swarmplot).</li>
            </ul>
        <p>
            <i>Визуализация ошибок 20 фолдов кросс-валидации HousePricePredictor и Stacking</i>
            <space20></space20>
            <img-center>
                <img 
                    src='img/Section8-Final-predictions/stack_hpp_compare.png'
                    style='background-color:#FFFFFF;'
                    onclick='clickSize(this)'>
                </img-center>
            </p>
        <h2>
            <a
                class='anchor'
                id='actual_predicted_prices'>
                </a>
            17. Актуальные и спрогнозированные цены
            </h2>
        <p>
            <i>Сопоставление актуальных и спрогнозированных HousePricePredictor цен (элементы по оси Х отсортированы в сторону увеличения суммарной жилой площади)</i>
            <space></space>
            <space></space>
            <img-center>
                <img
                    src='img/Section8-Final-predictions/predicted_actual_residuals.png'
                    style='background-color:#FFFFFF;'
                    onclick='clickSize(this)'>
                </img-center>
            <space></space>
            На первой трети графика заметно, что HousePricePredictor излишне оптимистичен и часто переоценивает дома. Во второй трети этот баланс выравнивается, но в третьей части появляется снова. Видимо, выбранная архитектура построения модели хорошо подходит для домов среднего размера, но для больших и маленьких домов модель должна быть скорректирована, что в теории приведет к увеличению возможностей для эффективного прогноза цены.
            </p>
        <h2>
            <a
                class='anchor'
                id='residuals_hpp'>
                </a>
            18. Анализ остатков HPP
            </h2>
        <p>
            В данном пункте исследуются остатки прогнозов HPP. 
            <space></space>
            В проекте несколько нарушена последовательность действий. На практике исследование остатков, сравнение актуальных и спрогнозированных цен необходимо производить на train-датасете, чтобы скорректировать модель и внести концептуальные исправления перед финальным тестом. Тем не менее, здесь этот требование нарушено, так как проект демонстрационный и не будет развиваться в дальнейшем. 
            <space></space>
            <i>Распределение остатков HousePricePredictor</i>
            <space></space>
            <img src='img/Section8-Final-predictions/hpp_residuals.png'>
            <space></space>
            Ни один тест не позволяет предполагать, что остатки распределены нормально. Попробуем удалить экстремальные значения ошибок (шесть элементов с остатками более 50000$, см. таблицу ниже).
            <space></space>
            <img-margin>
                <img
                    src='img/Section8-Final-predictions/residuals_been_cutted.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-margin>
            <space></space>
            После этого три из пяти тестов указывают на нормальность распределения.
            <space></space>
            <img-margin>
                <img
                    src='img/Section8-Final-predictions/residuals_cutted_tests.png'
                    style='border: 1px solid #CCCCCC;border-radius: 3px;'>
                </img-margin>
            <space></space>
            <i>Сравнение формы распределения остатков (до и после удаления выбросов) с формой нормального распределения</i>
            <space></space>
            <img src='img/Section8-Final-predictions/residuals_distributions_compare.png'>
            <space></space>
            Ранее было высказано предположение о наличии нескольких элементов, которые не вписываются в общий контекст. Возможно, по причине ошибки ввода данных или мошенничестве при заключении договора купли-продажи.
            <space></space>
            Отобразим взаимосвязь актуальных и спрогнозированных цен. Область между 100000 и 200000 имеет низкую дисперсию, в то время как у более дорогих домов разброс сильнее. 
            <space></space>
            <img src='img/Section8-Final-predictions/actual_predicted.png'>
            <space></space>
            Попробуем определить предиктор, который наилучшим образом отражает эту закономерность. После ряда тестов выяснилось, что таким предиктором является суммарная площадь первого и второго этажа <sb>grlivarea</sb> (что логично, так как этот признак сильнее других коррелирует с ценой).
            <space></space>
            Рассчитаем <sb>абсолютные</sb> и <sb>относительные ошибки</sb> и отобразим их взаимосвязь с <sb>grlivarea</sb>.
        <h4>
            <i>Абсолютные ошибки</i>
            </h4>
        <p>
            Для домов с суммарной жилой площадью менее 1900 футов RMSE равна 0.084705. <br>
            С увеличением площади дома значительно возрастает и дисперсия прогнозов - RMSE равна 0.132874. 
            <space></space>
            <img src='img/Section8-Final-predictions/grlivarea_residuals.png'>
            <space></space>
            </p>
        <h4>
            <i>Относительные ошибки (предсказанная цена относительно актуальной цены)</i>
            </h4>
        <p>
            С другой стороны, если взглянуть на относительные ошибки, то зависимость от величины жилой площади менее очевидна. Можно увидеть некоторые паттерны, если дополнительно построить линии локальной регрессии (LOWESS). Форма остатков в левой части графика напоминает форму вогнутой параболы с вершиной в районе площади, равной 1250. В правой части графика явно-выраженная закономерность отсутствует, что может быть следствием недостаточного числа элементов.
            <space></space>
            <space></space>
            <img src='img/Section8-Final-predictions/grlivarea_residuals_frac.png'>
            </p>
        <h2>
            <a
                class='anchor'
                id='further'>
                </a>
            19. Дальнейшие шаги
            </h2>
        <h4>
            <i>Предложение 1</i>
            </h4>
        <p>
             В пункте <i>"18. Анализ остатков HPP"</i> показано, что дисперсия остатков увеличивается с увеличением площади дома. Чем больше величина ошибок в абсолютном выражении, тем выше потери от неверно предсказанных цен. Поэтому можно разбить исходные данные на две группы - большие дома с суммарной площадью выше 1900 квадратных футов и маленькие дома с площадью ниже 1900 - и исследовать их отдельно друг от друга, чтобы построить две разные модели.
            </p>
        <h4>
            <i>Предложение 2</i>
            </h4>
        <p>
            Используя схему <sb>Stacking</sb> построить ансамбль, в котором алгоритмы нижнего уровня обучаются не на полных данных, а на группах, сформированных в пункте <i>"8. Создание дополнительных предикторов"</i> - площадь, география, качество материалов и т.д.
            </p>
        <h4>
            <i>Предложение 3</i>
            </h4> 
        <p>
            Предиктор <sb>neighborhood</sb> имеет высокий коэффициент корреляции (0.81), и высоко котируется большинством моделей машинного обучения. При этом он не использовался для построения линейной регрессии, чтобы не усложнять её интерпретацию. В перспективе можно более детально изучить географию местности и её взаимосвязь с целевой переменной. Возможно, объединить некоторые районы в один предиктор. 
            <space></space>
            Еще один предиктор, на который стоит обратить внимание - это <sb>functional</sb>.
            </p>
    </div>
</div>
<script>
    let mybutton = document.getElementById('toTocBtn');
    
    // When the user scrolls down 20px from the top of the document, show the button
    window.onscroll = function() {scrollFunction()};
    
    function scrollFunction() {
      if (document.body.scrollTop > 1215 || document.documentElement.scrollTop > 1215) {
        mybutton.style.display = "block";
      } else {
        mybutton.style.display = "none";
      }
    }
    
    // When the user clicks on the button, scroll to the top of the document
    function topFunction() {
      document.body.scrollTop = 290; // For Safari
      document.documentElement.scrollTop = 290; // For Chrome, Firefox, IE and Opera
    }

    function scrollToID(id) {
        let element = document.getElementById(id);
        element.scrollIntoView({
          block: 'start',
          // behavior: 'smooth',
          inline: 'start'
        });
    }
    </script>
<script>
    // Get the img object using its Id
        img = document.getElementById("img1");
        // Function to increase image size
        function enlargeImg(id) {
            let img = document.getElementById(id);
            // Set image size to 1.5 times original
            img.style.transform = "scale(1.5)";
            // Animation effect
            img.style.transition = "transform 0.25s ease";
        }
        // Function to reset image size
        function resetImg(id) {
            let img = document.getElementById(id);
            // Set image size to original
            img.style.transform = "scale(1)";
            img.style.transition = "transform 0.25s ease";
            }

    function clickSize(img) {
      img.classList.toggle('change-size');
    }
        
</script>
    <pageend></pageend>
</body>
</html>